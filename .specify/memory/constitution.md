# Speckit Constitution

**Scope**: Speckit workflow governance (spec → plan → tasks → implement)
**Authority**: Derives from CLAUDE.md (project source of truth)
**Version**: 3.0.0 | **Last Updated**: 2025-11-24

---

> This Constitution governs the Speckit workflow exclusively. For framework-wide
> principles (TDD, Value/Complexity, Reuse-First), see CLAUDE.md. This document
> adds speckit-specific rules and enforcement mechanisms.

---

## Article I — Scope & Inheritance

**Section 1. Scope.** This Constitution applies only to the Speckit workflow
(`/speckit.specify`, `/speckit.plan`, `/speckit.tasks`, `/speckit.implement`,
`/speckit.analyze`, `/speckit.clarify`).

**Section 2. Inheritance.** All principles from CLAUDE.md apply within Speckit.
This Constitution may add constraints but never relax CLAUDE.md requirements.

**Section 3. Conflict Resolution.** If this Constitution conflicts with CLAUDE.md,
CLAUDE.md prevails. Report conflicts for resolution.

---

## Article II — TDD Enforcement

**Section 1. Mandatory TDD.** Per CLAUDE.md §TDD Loop, Test-Driven Development
is mandatory for all implementation tasks generated by Speckit.

**Section 2. Task Structure.** For each implementation component, tasks.md MUST
include a preceding test task:

```text
- [ ] T00X [TEST] Write test for ComponentName in tests/path/test_component.py
- [ ] T00Y Implement ComponentName in src/path/component.py
```

**Section 3. TDD Exception Declaration.** When TDD is impractical, users MAY
declare an exception in the tasks.md header. Exceptions require:

```markdown
### TDD Exception Declaration

| Field | Value |
|-------|-------|
| **Reason** | [legacy-code | hotfix-critical | generated-code | prototype-throwaway | user-directive] |
| **Justification** | [Specific explanation why TDD is impractical] |
| **Mitigation** | [Alternative quality assurance: manual QA, post-deploy tests, etc.] |
| **Approved** | [User confirmation timestamp] |
```

**Section 4. Valid Exception Reasons.**

- `legacy-code`: Existing codebase without test infrastructure; refactoring exceeds scope
- `hotfix-critical`: Production emergency where time < comprehensive testing
- `generated-code`: Auto-generated code not amenable to unit testing
- `prototype-throwaway`: Explicitly temporary code to be discarded
- `user-directive`: User explicitly requests skipping tests with full awareness of risks

**Section 4.1. User Directive Warning.** When reason is `user-directive`, the
system MUST display:

```text
⚠️  TDD EXCEPTION: User Directive
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
You are bypassing TDD requirements. This decision:
- Violates CLAUDE.md §TDD Loop best practices
- May result in undetected bugs and regressions
- Transfers quality assurance responsibility to manual testing
- Will be permanently documented in this artifact

Proceeding as requested.
```

This warning is logged in tasks.md and cannot be suppressed.

**Section 5. Exception Behavior.**

- Without exception: `/speckit.tasks` rejects task generation without test tasks
- With valid exception: Proceeds with warning; exception documented in artifact
- With invalid/incomplete exception: Rejects; requests complete justification

---

## Article III — SDD Artifacts

**Section 1. Required Artifacts.** The Speckit workflow produces these artifacts
in `FEATURE_DIR/`:

| Artifact | Command | Purpose |
|----------|---------|---------|
| `spec.md` | `/speckit.specify` | Feature specification with user stories |
| `plan.md` | `/speckit.plan` | Technical design and architecture |
| `tasks.md` | `/speckit.tasks` | Actionable implementation checklist |

**Section 2. Optional Artifacts.** Generated when applicable:

| Artifact | Purpose |
|----------|---------|
| `data-model.md` | Entity definitions and relationships |
| `contracts/` | API specifications (OpenAPI, GraphQL, etc.) |
| `research.md` | Technical decisions and trade-offs |
| `quickstart.md` | Integration scenarios and examples |
| `checklists/` | Quality gates (UX, security, accessibility) |

**Section 3. Artifact Integrity.**

- Artifacts are **append-only** during implementation; deletions require justification
- Cross-references between artifacts MUST remain consistent
- `/speckit.analyze` validates artifact consistency before implementation

**Section 4. Language Requirements.** Per CLAUDE.md §Documentation:

- Artifact content: Spanish (human-facing documentation)
- Code examples within artifacts: English
- Technical terms (APIs, frameworks): English as jargon within Spanish text

---

## Article IV — Speckit Gates

**Section 1. Pre-Implementation Gates.** Before `/speckit.implement` executes:

| Gate | Validation | Failure Action |
|------|------------|----------------|
| **Artifact Existence** | spec.md, plan.md, tasks.md exist | Block; suggest missing command |
| **TDD Compliance** | Test tasks precede implementation tasks OR valid exception declared | Block; request tests or exception |
| **Checklist Completion** | All checklists in `checklists/` are 100% complete | Warn; ask user confirmation to proceed |
| **Consistency Check** | `/speckit.analyze` passed without CRITICAL issues | Warn; display issues and ask confirmation |

**Section 2. Task Execution Gates.** During implementation:

| Gate | Validation | Failure Action |
|------|------------|----------------|
| **Dependency Order** | Sequential tasks complete before dependents | Block; complete prerequisites first |
| **Phase Completion** | All tasks in phase complete before next phase | Block; complete current phase |
| **Test-First Order** | [TEST] tasks execute before corresponding implementation | Block; run test first |

**Section 3. Post-Implementation Gates.** After `/speckit.implement` completes:

| Gate | Validation | Failure Action |
|------|------------|----------------|
| **Task Completion** | All tasks marked [X] in tasks.md | Warn; list incomplete tasks |
| **Test Passing** | All tests pass (if test suite exists) | Block; fix failing tests |
| **Spec Alignment** | Implementation matches spec.md user stories | Warn; note deviations |

---

## Article V — Amendment

**Section 1. Amendment Process.** Changes to this Constitution require:

1. Written proposal with rationale and impact analysis
2. Verification that change doesn't conflict with CLAUDE.md
3. User approval before implementation
4. Version increment and date update in header

**Section 2. Version History.**

| Version | Date | Change Summary |
|---------|------|----------------|
| 3.0.0 | 2025-11-24 | Restructured as speckit-specific; TDD enforcement with exceptions |
| 2.4.0 | 2025-11-23 | Previous version (framework-wide scope) |

---

## Ratification

This Constitution governs Speckit workflow execution. Authority derives from
CLAUDE.md. Compliance is verified at each gate defined in Article IV.
